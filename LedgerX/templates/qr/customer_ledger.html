{% extends 'base_public.html' %} 
{# Use a public base if you have one to hide the sidebar from customers #}

{% block content %}
<div class="container py-4">
    <div class="card border-0 bg-dark text-white p-4 mb-4 shadow-lg animate__animated animate__fadeInDown" style="border-radius: 24px;">
        <div class="d-flex justify-content-between align-items-center">
            <div>
                <p class="small text-white-50 mb-0">Current Outstanding</p>
                <h2 class="fw-bold text-emerald mb-0">₹{{ outstanding_amount }}</h2>
            </div>
            <div class="text-end">
                <div class="fw-bold">{{ customer.name }}</div>
                <div class="x-small text-white-50">Last updated: Today</div>
            </div>
        </div>
    </div>

    <h5 class="fw-bold mb-3 px-2">Payment History</h5>

    <div class="card border-0 shadow-sm overflow-hidden" style="border-radius: 20px;">
        <div class="table-responsive">
            <table class="table align-middle mb-0">
                <thead class="bg-light text-muted x-small">
                    <tr>
                        <th class="ps-4">DATE</th>
                        <th>TYPE</th>
                        <th class="text-end pe-4">BALANCE</th>
                    </tr>
                </thead>
                <tbody>
                    {% for row in ledger_rows %}
                    <tr>
                        <td class="ps-4">
                            <div class="small fw-bold">{{ row.tx.transaction_date|date:"d M" }}</div>
                        </td>
                        <td>
                            <span class="x-small fw-bold uppercase 
                                {% if row.tx.transaction_type == 'PAYMENT' %}text-success{% else %}text-muted{% endif %}">
                                {{ row.tx.transaction_type }}
                            </span>
                        </td>
                        <td class="text-end pe-4">
                            <div class="small fw-bold {% if row.balance > 0 %}text-danger{% else %}text-success{% endif %}">
                                ₹{{ row.abs_balance }}
                            </div>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
    
    <div class="text-center mt-5">
        <p class="text-muted x-small">Powered by LedgerX for {{ customer.shop.name }}</p>
    </div>
</div>
{% endblock %}